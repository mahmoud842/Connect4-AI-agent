# Connect 4 AI Game with Backend Integration

A beautiful Connect 4 game with AI powered by Minimax and Expectiminimax algorithms with optional Alpha-Beta pruning. **Backend is now fully integrated!**

## Features

âœ¨ **Game Features:**

- ðŸŽ® Interactive 7x6 Connect 4 board with realistic styling
- ðŸ¤– AI opponent using Minimax or Expectiminimax algorithms
- âš¡ Optional Alpha-Beta pruning optimization
- ðŸŽ¯ Configurable K value (4 or more in a row to win)
- ðŸ‘¥ Choose who starts first (AI or Human)
- ðŸ”„ Reset game functionality
- ðŸ“Š Score tracking with terminal state scoring
- ðŸŽµ Realistic plastic drop sound effects
- ðŸŽ¨ Beautiful animations and gradients

ðŸŒ³ **Tree Visualization:**

- View actual game tree generated by backend algorithms
- Professional React Flow visualization
- Color-coded nodes (MAX=Red, MIN=Yellow, CHANCE=Purple, LEAF=Green)
- Shows move (column) and value for each node
- Navigate between game and tree view
- Centered tree layout algorithm

## Quick Start

### Prerequisites

- Node.js 20+
- Python 3.8+

### 1. Install Dependencies

```bash
# Install frontend dependencies
npm install

# Install backend dependencies (Flask)
pip3 install Flask flask-cors
```

### 2. Start Backend Server

**Terminal 1:**

```bash
python3 backend_server.py
```

You should see:

```
ðŸš€ Starting Connect4 AI Backend Server...
ðŸ“¡ Server running on http://localhost:5000
ðŸŽ® Ready to receive requests from React frontend
```

### 3. Start Frontend

**Terminal 2:**

```bash
npm run dev
```

Open your browser to: **http://localhost:5173**

## How to Play

1. **Configure Game:**

   - Choose algorithm: Minimax or Expectiminimax
   - Enable/disable Alpha-Beta pruning for faster computation
   - Select K value (how many in a row to win, â‰¥4)
   - Select who starts first (AI or Human)
   - Click "Launch Game"

2. **Play the Game:**

   - Click on any column to drop your piece (red)
   - AI will automatically calculate the best move and play (yellow)
   - Try to connect K pieces horizontally, vertically, or diagonally

3. **View Game Tree:**

   - Click "View Tree ðŸŒ³" button during the game
   - See the actual decision tree used by the AI
   - Nodes show move (column) and evaluation value
   - Click "Back to Game" to return

4. **Reset or Play Again:**
   - Use "Reset Game" button to restart current game
   - When game ends, choose "Play Again" to restart

## Architecture

### Backend Integration Flow

```
Frontend (React)  â†’  Flask Backend  â†’  Minimax/Alpha-Beta Modules
     â†“                     â†“                      â†“
  Display          Convert formats         Game logic
  Results          Return JSON            State trees
```

**Key Design Decisions:**

- âœ… Backend files (`minimax.py`, `alpha_beta.py`, `state.py`) are **NOT modified**
- âœ… `backend_server.py` acts as integration layer
- âœ… Converts between frontend format (null/"human"/"ai") and backend format (0/-1/1)
- âœ… Human moves: Only validate and check terminal state
- âœ… AI moves: Run full minimax tree search and return tree + best move
- âœ… Tree conversion: Backend State objects â†’ Frontend JSON format

### API Endpoints

#### `POST /api/move`

Make a move (human validation or AI calculation)

**Request:**

```json
{
  "board": [[null, "human", "ai", ...], ...],
  "player": "human" | "ai",
  "column": 0-6,  // Only for human moves
  "algorithm": "minimax" | "expectiminimax",
  "useAlphaBeta": true | false,
  "k": 4,
  "firstPlayer": "human" | "ai"
}
```

**Response:**

```json
{
  "board": [[null, "human", "ai", ...], ...],
  "column": 0-6,
  "gameOver": true | false,
  "winner": "human" | "ai" | "draw" | null,
  "score": { "human": 0, "ai": 0 },
  "tree": { "value": 100, "player": "MAX", "move": 3, "children": [...] },
  "value": 100  // Only for AI moves
}
```

#### `POST /api/game-status`

Check current game status

#### `GET /api/health`

Health check endpoint

See [SETUP.md](SETUP.md) for detailed API documentation.

## Project Structure

```
Connect4-AI-Agent/
â”œâ”€â”€ backend_server.py             # Flask integration layer (NEW!)
â”œâ”€â”€ start_backend.sh              # Quick start script
â”œâ”€â”€ requirements.txt              # Python dependencies
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ minimax.py                # Minimax algorithm (NOT MODIFIED)
â”‚   â”œâ”€â”€ alpha_beta.py             # Alpha-beta pruning (NOT MODIFIED)
â”‚   â”œâ”€â”€ expected_minimax.py       # Expectiminimax (NOT MODIFIED)
â”‚   â”œâ”€â”€ expected_alpha_beta.py    # Expectiminimax + pruning (NOT MODIFIED)
â”‚   â”œâ”€â”€ state.py                  # Game state class (NOT MODIFIED)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ GameConfig.jsx        # Game configuration (7x6 board, K config)
â”‚   â”‚   â”œâ”€â”€ GameBoard.jsx         # Main game with backend integration
â”‚   â”‚   â””â”€â”€ *.css
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ TreeFlow.jsx          # React Flow tree visualization
â”‚   â”‚   â””â”€â”€ *.css
â”‚   â”œâ”€â”€ App.jsx                   # Routing and state management
â”‚   â””â”€â”€ main.jsx
â”œâ”€â”€ package.json
â”œâ”€â”€ SETUP.md                      # Detailed setup guide
â””â”€â”€ README.md                     # This file
```

## Technologies Used

- **Frontend:**

  - React 19.2.0
  - React Router DOM
  - @xyflow/react (React Flow for tree visualization)
  - Vite 7.2.4
  - Web Audio API for sounds

- **Backend:**

  - Flask 3.0.0
  - Flask-CORS 4.0.0
  - Python 3.8+

- **Game Logic:**
  - Minimax algorithm
  - Alpha-Beta pruning
  - Expectiminimax with chance nodes
  - Heuristic evaluation function

## Current Status

âœ… **Completed:**

- Game configuration UI with K value input
- Fixed 7x6 Connect 4 board with animations
- Score tracking using backend terminal_score()
- Full backend integration with Flask
- Minimax and Expectiminimax algorithms
- Alpha-Beta pruning optimization
- Tree visualization with React Flow
- Move labels on tree nodes (Col X)
- Proper tree layout algorithm
- Sound effects (realistic plastic click)
- Game over detection
- Reset functionality
- State persistence across navigation
- Data format conversion (frontend â†” backend)

## Troubleshooting

### Backend Connection Error

If you see "Failed to connect to backend server":

1. Ensure Flask backend is running: `python backend_server.py`
2. Check backend terminal for errors
3. Verify port 5000 is not in use: `lsof -i :5000`
4. Test health endpoint: `curl http://localhost:5000/api/health`

### Python Import Errors

Ensure all backend files are in `src/` directory:

- `src/minimax.py`
- `src/alpha_beta.py`
- `src/expected_minimax.py`
- `src/expected_alpha_beta.py`
- `src/state.py`

### Tree Not Showing

- Tree only generates on AI moves
- Make at least one AI move before clicking "View Tree"
- Check browser console for errors
- Verify sessionStorage has tree data: `sessionStorage.getItem('currentTree')`

## Development Notes

- **Backend files are immutable**: Do not modify files in `src/` directory
- **AI is always MAX**: Backend uses player value 1 for AI
- **Board format conversion**: null/human/ai â†” 0/-1/1
- **K value**: Dynamically set in backend before algorithm runs
- **Tree generation**: Only on AI moves to show decision process
- **State preservation**: Game state persists when navigating to tree view

For detailed setup instructions, see [SETUP.md](SETUP.md).

Enjoy playing Connect 4 with AI! ðŸŽ®ðŸ¤–
